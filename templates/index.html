$def with(n,m,f,hsize,lsize,low,hig)
<html>
	<head>
	<script>
		var nowb = -1;
		var speed = 0;
		var setcolor = function(i,j,co){
			if (co!=""){
				document.getElementById("table").rows[i].cells[j].style.background = co;
			}
		}

		var setborder = function(i,j,st){
			if (st!=""){
				document.getElementById("table").rows[i].cells[j].style.border = st;
			}
		}	
		var getjson = function(){
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.open("GET",window.location.href+"history",false);
			xmlhttp.send();
			his = eval("(" +xmlhttp.responseText+")");
			n = document.getElementById("table").rows.length;
			m = document.getElementById("table").rows[0].cells.length;
			return true;
		}
		var draw = function(x,w,co,bo){
			var i,j,a,b,c,d;
			a = his[x][w]['a'];
			b = his[x][w]['b'];
			c = his[x][w]['c'];
			d = his[x][w]['d'];
			i = a -1;
			do{
				j = b -1;
				i = (i + 1)%n;
				do{
					j = (j + 1)%m;
					setcolor(i,j,co);
					setborder(i,j,bo);
				}while(j!=d);
			}while(i!=c);
			document.getElementById(w).innerHTML = his[x][w]['sum'];
		}

		var renew = function(){
			var i,j;
			for(i=0;i<n;i++)
				for(j=0;j<m;j++)
				{
					setcolor(i,j,'white');
					setborder(i,j,'2px dotted black');
				}
		}

		var drawit = function(){
			var i,j;
			renew();
			if(nowb>=0){
				draw(nowb,'now',"#AAAAAA","");
				draw(nowb,'max',"","2px solid blue");
			}
		}
		
		var drawnext = function(){
			if(nowb < his.length-1){
				nowb += 1;
			}
			drawit();
			document.getElementById("step").innerHTML = nowb+1;
		}
	
		var drawlast = function(){
			if(nowb>=0){
				nowb -= 1;
			}
			drawit();
			document.getElementById("step").innerHTML = nowb+1;
		}
		
		var autogo = function(){
			if (speed>0){
				drawnext();
			}
			else{
				drawlast();
			}
			if (speed){
				setTimeout("autogo()",1000/Math.abs(speed));
			}
		}	

		var stop = function(){
			speed = 0;
		}
	
		var go	= function(x){
			if (speed == 0){
				speed = x;
				autogo();
			}else{
				speed += x;
			}
		}
	</script>
	<title>HeiHei</title>
	<style>
	td
	{
  		border:2px dotted black;
		width:30px;
		height:30px;
		background-color: white;
	}
	body 
	{
		background-color: #EEEEEE;
		font-family: Arial;
		font-size: 12pt;
		margin: 3% 10% 5% 10%;
		padding: 4% 5% 0% 5%;
		width: 70%;
		border: 1px solid #000000;
		line-height: 100%
	}
	#t
	{
		width: 40px;
	}		
	</style>
	</head>
<body align="center" onload="getjson()">
	<h1>一维/二维最大子矩阵和求解图形化展示</h1>
	<p align="right">by <b>forwil 11091222</b></p>
	<form method="POST" enctype="multipart/form-data" action="">
		<hr/>
		<input type="file" name="myfile" />
		<hr/>
		Row:<input type="text" name="hsize" id="t" maxlength="4" value="$hsize">
		Col:<input type="text" name="lsize" id="t" maxlength="4" value="$lsize">
		<input type="submit" value="Start">
		<br/>
		Random nowber From:<input type="text" name="low"  id="t" maxlength="4" value="$low">
		to	:<input type="text" name="hig"  id="t" maxlength="4" value="$hig">
		<br/>
		-h<input type="checkbox" name="h">
		-v<input type="checkbox" name="v">
		<hr/>
		<input type="button" value="Stop" onclick="stop()">
		<br/>
		<input type="button" value="<<" onclick="go(-1)">
		<input type="button" value="<" onclick="drawlast()" >
		Step:<span id="step">0</span>
		<input type="button" value=">" onclick="drawnext()">
		<input type="button" value=">>" onclick="go(1)">
		<br/>
	$if f:
		<b>n = $n </b>
		<b>m = $m</b>
		<table align="center" id="table">
		$for i in range(0,n):
			<tr>
			$for j in range(0,m):
				<td>$f[i][j]</td>
			</tr>
		</table>
		Now sum is:<b><span id="now"></span></b><br/>
		Max sum is:<b><span id="max"></span></b>
	</form>
</body>
</html>
